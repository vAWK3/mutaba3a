import{r as h,j as e,L as M}from"./vendor-router-D4Yqsbqz.js";import{u as D,a as L,af as b,n as I,T as y,p as U,c as A,l as i}from"./index-DxpiON0U.js";import"./vendor-react-BdxwsYZ-.js";import"./vendor-query-CI0tl4qS.js";import"./vendor-db-BMy7eggi.js";import"./vendor-forms-CPtPuEGg.js";function F(){const a=D(),{language:S}=L(),l=I(S),v=new Date().getFullYear(),[o,g]=h.useState(v),{data:c=[],isLoading:f}=b(o),N=Array.from({length:6},(t,s)=>v-s),n=h.useMemo(()=>{let t=0,s=0;const r=new Array(12).fill(0),x=new Array(12).fill(0);return c.forEach(m=>{t+=m.totalMinorUSD,s+=m.totalMinorILS,m.monthlyBreakdown.forEach(d=>{r[d.month-1]+=d.totalMinorUSD,x[d.month-1]+=d.totalMinorILS})}),{totalUSD:t,totalILS:s,monthlyTotalsUSD:r,monthlyTotalsILS:x}},[c]),p=n.monthlyTotalsUSD,j=Math.max(...p,1),w=h.useMemo(()=>Array.from({length:12},(t,s)=>new Date(o,s,1).toLocaleDateString(l,{month:"short"})),[o,l]),u=h.useMemo(()=>[...c].sort((t,s)=>{const r=t.totalMinorUSD+t.totalMinorILS;return s.totalMinorUSD+s.totalMinorILS-r}),[c]);return e.jsxs(e.Fragment,{children:[e.jsx(y,{title:a("expenses.overview.title"),breadcrumbs:[{label:a("nav.expenses"),href:"/expenses"},{label:a("expenses.overview.title")}],filterSlot:e.jsx("div",{className:"filters-row",style:{marginBottom:0,marginInlineStart:24},children:e.jsx("select",{className:"select",value:o,onChange:t=>g(Number(t.target.value)),children:N.map(t=>e.jsx("option",{value:t,children:t},t))})})}),e.jsx("div",{className:"page-content",children:f?e.jsx("div",{className:"loading",children:e.jsx("div",{className:"spinner"})}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"overview-grand-total",children:[e.jsxs("div",{className:"overview-grand-total-label",children:[a("expenses.overview.totalExpenses")," (",o,")"]}),e.jsx(U,{usdAmountMinor:n.totalUSD,ilsAmountMinor:n.totalILS,eurAmountMinor:0,type:"expense",size:"large"})]}),e.jsxs("div",{className:"overview-chart-section",children:[e.jsxs("h3",{className:"section-title",children:[a("expenses.overview.monthlyBreakdown")," (USD)"]}),e.jsx("div",{className:"overview-bar-chart",children:p.map((t,s)=>{const r=j>0?t/j*100:0;return e.jsxs("div",{className:"chart-bar-container",children:[e.jsx("div",{className:"chart-bar-wrapper",children:e.jsx("div",{className:A("chart-bar",t>0&&"has-value"),style:{height:`${Math.max(r,2)}%`}})}),e.jsx("div",{className:"chart-bar-label",children:w[s]}),e.jsx("div",{className:"chart-bar-value",children:t>0?i(t,"USD",l):"-"})]},s)})})]}),e.jsxs("div",{className:"overview-breakdown-section",children:[e.jsx("h3",{className:"section-title",children:a("expenses.overview.byProfile")}),u.length===0?e.jsx("div",{className:"empty-state",children:e.jsx("p",{className:"text-muted",children:a("expenses.overview.noProfiles")})}):e.jsx("div",{className:"data-table",children:e.jsxs("table",{children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:a("expenses.overview.profile")}),e.jsx("th",{style:{textAlign:"end"},children:"USD"}),e.jsx("th",{style:{textAlign:"end"},children:"ILS"})]})}),e.jsx("tbody",{children:u.map(t=>e.jsxs("tr",{children:[e.jsx("td",{children:e.jsx(M,{to:"/expenses/profile/$profileId",params:{profileId:t.profileId},style:{fontWeight:500},children:t.profileName})}),e.jsx("td",{className:"amount-cell amount-negative",children:t.totalMinorUSD>0?i(t.totalMinorUSD,"USD",l):"-"}),e.jsx("td",{className:"amount-cell amount-negative",children:t.totalMinorILS>0?i(t.totalMinorILS,"ILS",l):"-"})]},t.profileId))}),e.jsx("tfoot",{children:e.jsxs("tr",{children:[e.jsx("td",{style:{fontWeight:600},children:a("expenses.overview.total")}),e.jsx("td",{className:"amount-cell amount-negative",style:{fontWeight:600},children:n.totalUSD>0?i(n.totalUSD,"USD",l):"-"}),e.jsx("td",{className:"amount-cell amount-negative",style:{fontWeight:600},children:n.totalILS>0?i(n.totalILS,"ILS",l):"-"})]})})]})})]})]})})]})}export{F as ExpensesOverviewPage};
