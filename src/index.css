/* ============================================
   Design System - Mini CRM
   ============================================

   IMPORTANT: This file contains LEGACY variables for backwards compatibility.

   For NEW development, use canonical tokens from src/styles/theme.css
   See .claude/PATTERNS.md for the full token reference guide.

   Tech Debt: TD-011 tracks migration of legacy tokens.
   ============================================ */

/* ============================================
   DEPRECATED: Legacy Color Variables
   ============================================

   These --color-* variables are DEPRECATED and exist only for
   backwards compatibility with existing components.

   DO NOT USE in new code. Use canonical tokens instead:

   | Deprecated              | Use Instead          |
   |-------------------------|----------------------|
   | --color-bg              | --bg                 |
   | --color-surface         | --surface            |
   | --color-bg-elevated     | --surface            |
   | --color-text            | --text               |
   | --color-text-secondary  | --text-secondary     |
   | --color-text-muted      | --muted              |
   | --color-primary         | --accent             |
   | --color-primary-light   | --accent-subtle      |
   | --color-success         | --success            |
   | --color-warning         | --warning            |
   | --color-danger          | --error              |
   | --color-error           | --error              |
   | --color-border          | --border             |

   ============================================ */
:root {
  /* @deprecated Use --bg instead */
  --color-bg: var(--bg);
  /* @deprecated Use --surface instead */
  --color-surface: var(--surface);
  /* @deprecated Use --surface-hover instead */
  --color-surface-hover: var(--surface-hover);
  /* @deprecated Use --surface-2 instead */
  --color-surface-alt: var(--surface-2);
  /* @deprecated Use --surface instead */
  --color-bg-elevated: var(--surface);
  /* @deprecated Use --surface-hover instead */
  --color-bg-hover: var(--surface-hover);
  /* @deprecated Use --surface-2 instead */
  --color-bg-active: var(--surface-2);

  /* @deprecated Use --border instead */
  --color-border: var(--border);
  /* @deprecated Use --border-strong instead */
  --color-border-strong: var(--border-strong);

  /* @deprecated Use --text instead */
  --color-text: var(--text);
  /* @deprecated Use --text-secondary instead */
  --color-text-secondary: var(--text-secondary);
  /* @deprecated Use --muted instead */
  --color-text-muted: var(--muted);

  /* @deprecated Use --accent instead */
  --color-primary: var(--accent);
  /* @deprecated Use --accent-hover instead */
  --color-primary-hover: var(--accent-hover);
  /* @deprecated Use --accent-subtle instead */
  --color-primary-light: var(--accent-subtle);

  /* @deprecated Use --success instead */
  --color-success: var(--success);
  /* @deprecated Use --success-subtle instead */
  --color-success-light: var(--success-subtle);

  /* @deprecated Use --warning instead */
  --color-warning: var(--warning);
  /* @deprecated Use --warning-subtle instead */
  --color-warning-light: var(--warning-subtle);

  /* @deprecated Use --error instead */
  --color-danger: var(--error);
  /* @deprecated Use --error-subtle instead */
  --color-danger-light: var(--error-subtle);

  /* @deprecated Use --error instead */
  --color-error: var(--error);
  /* @deprecated Use --error-subtle instead */
  --color-error-bg: var(--error-subtle);
  /* @deprecated Use --error-muted instead */
  --color-error-border: var(--error-muted);

  /* @deprecated Use --accent instead */
  --color-accent: var(--accent);
  /* @deprecated Use --accent-subtle instead */
  --color-accent-subtle: var(--accent-subtle);

  /* Semantic transaction colors - these map to standard semantic tokens */
  /* @deprecated Use --success instead */
  --color-income: var(--success);
  /* @deprecated Use --text-secondary instead */
  --color-expense: var(--text-secondary);
  /* @deprecated Use --warning instead */
  --color-unpaid: var(--warning);
  /* @deprecated Use --error instead */
  --color-overdue: var(--error);

  /* ============================================
     DEPRECATED: Legacy Spacing (px values)
     ============================================

     theme.css defines spacing in rem for better accessibility.
     These px-based values exist for backwards compatibility.

     Canonical tokens use the same names but with rem values.
     The rem values from theme.css will take precedence when
     theme.css is imported after this file.
     ============================================ */

  /* Note: theme.css spacing tokens override these with rem values */
  /* Keep for components that haven't migrated yet */

  /* ============================================
     Layout Constants (NOT deprecated)
     ============================================
     These are shared with theme.css and are canonical.
     ============================================ */
  --sidebar-width: 240px;
  --topbar-height: 56px;
  --drawer-width: 480px;
  --table-row-height: 44px;

  /* ============================================
     DEPRECATED: Legacy Typography Variables
     ============================================

     DO NOT USE in new code. Use canonical tokens instead:

     | Deprecated            | Use Instead       |
     |-----------------------|-------------------|
     | --font-size-xs        | --text-xs         |
     | --font-size-sm        | --text-sm         |
     | --font-size-base      | --text-base       |
     | --font-size-md        | --text-md         |
     | --font-size-lg        | --text-lg         |
     | --font-size-xl        | --text-xl         |
     | --font-size-2xl       | --text-2xl        |
     | --font-weight-normal  | --weight-normal   |
     | --font-weight-medium  | --weight-medium   |
     | --font-weight-semibold| --weight-semibold |
     | --font-family         | --font-en         |
     | --font-mono           | --font-mono       |

     ============================================ */

  /* @deprecated Use --font-en from theme.css instead */
  --font-family:
    -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu,
    sans-serif;
  /* @deprecated theme.css has --font-mono with better stack */
  --font-mono: "SF Mono", Monaco, Consolas, "Liberation Mono", monospace;

  /* @deprecated Use --text-xs instead */
  --font-size-xs: 11px;
  /* @deprecated Use --text-sm instead */
  --font-size-sm: 12px;
  /* @deprecated Use --text-base instead */
  --font-size-base: 13px;
  /* @deprecated Use --text-md instead */
  --font-size-md: 14px;
  /* @deprecated Use --text-lg instead */
  --font-size-lg: 16px;
  /* @deprecated Use --text-xl instead */
  --font-size-xl: 18px;
  /* @deprecated Use --text-2xl instead */
  --font-size-2xl: 20px;

  /* @deprecated Use --weight-normal instead */
  --font-weight-normal: 400;
  /* @deprecated Use --weight-medium instead */
  --font-weight-medium: 500;
  /* @deprecated Use --weight-semibold instead */
  --font-weight-semibold: 600;

  /* @deprecated Use --leading-tight instead */
  --line-height-tight: 1.25;
  /* @deprecated Use --leading-normal instead */
  --line-height-normal: 1.5;

  /* ============================================
     Border Radius (NOT deprecated)
     ============================================
     These match theme.css and are canonical.
     ============================================ */
  --radius-sm: 4px;
  --radius-md: 6px;
  --radius-lg: 8px;
  --radius-xl: 12px;

  /* ============================================
     DEPRECATED: Legacy Shadow Variables
     ============================================

     DO NOT USE in new code. Use canonical tokens instead:

     | Deprecated     | Use Instead  |
     |----------------|--------------|
     | --shadow-sm    | --shadow-1   |
     | --shadow-md    | --shadow-2   |
     | --shadow-lg    | --shadow-3   |

     Note: theme.css shadows have proper dark mode support.
     ============================================ */

  /* @deprecated Use --shadow-1 instead */
  --shadow-sm: 0 1px 2px rgba(0, 0, 0, 0.05);
  /* @deprecated Use --shadow-2 instead */
  --shadow-md: 0 4px 6px rgba(0, 0, 0, 0.07);
  /* @deprecated Use --shadow-3 instead */
  --shadow-lg: 0 10px 15px rgba(0, 0, 0, 0.1);
  /* @deprecated Use --drawer-shadow instead */
  --shadow-drawer: -4px 0 15px rgba(0, 0, 0, 0.1);

  /* ============================================
     Transitions (NOT deprecated)
     ============================================
     These are fine to use, though consider using
     CSS transition shorthand directly.
     ============================================ */
  --transition-fast: 150ms ease;
  --transition-normal: 200ms ease;
}

/* Reset */
*,
*::before,
*::after {
  box-sizing: border-box;
}

* {
  margin: 0;
  padding: 0;
}

html,
body,
#root {
  height: 100%;
}

body {
  /* Using theme.css variables for dark mode support */
  font-family: var(--font-en, var(--font-family));
  font-size: var(--text-base, var(--font-size-base));
  line-height: var(--leading-normal, var(--line-height-normal));
  color: var(--text);
  background-color: var(--bg);
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

/* Typography */
h1,
h2,
h3,
h4,
h5,
h6 {
  font-weight: var(--font-weight-semibold);
  line-height: var(--line-height-tight);
}

h1 {
  font-size: var(--font-size-2xl);
}
h2 {
  font-size: var(--font-size-xl);
}
h3 {
  font-size: var(--font-size-lg);
}
h4 {
  font-size: var(--font-size-md);
}

/* Links */
a {
  color: var(--color-primary);
  text-decoration: none;
}

a:hover {
  text-decoration: underline;
}

/* Buttons */
button {
  font-family: inherit;
  font-size: var(--font-size-base);
  cursor: pointer;
  border: none;
  background: none;
}

button:disabled {
  cursor: not-allowed;
  opacity: 0.5;
}

/* Inputs */
input,
select,
textarea {
  font-family: inherit;
  font-size: var(--font-size-base);
}

input:focus,
select:focus,
textarea:focus {
  outline: none;
}

/* Tables */
table {
  border-collapse: collapse;
  width: 100%;
}

th,
td {
  text-align: left;
  padding: var(--space-3) var(--space-4);
}

/* Utility Classes */
.text-muted {
  color: var(--color-text-muted);
}
.text-secondary {
  color: var(--color-text-secondary);
}
.text-success {
  color: var(--color-success);
}
.text-warning {
  color: var(--color-warning);
}
.text-danger {
  color: var(--color-danger);
}

.text-sm {
  font-size: var(--font-size-sm);
}
.text-xs {
  font-size: var(--font-size-xs);
}
.text-md {
  font-size: var(--font-size-md);
}
.text-lg {
  font-size: var(--font-size-lg);
}

.font-medium {
  font-weight: var(--font-weight-medium);
}
.font-semibold {
  font-weight: var(--font-weight-semibold);
}

.text-right {
  text-align: right;
}
.text-center {
  text-align: center;
}

/* Scrollbar */
::-webkit-scrollbar {
  width: 8px;
  height: 8px;
}

::-webkit-scrollbar-track {
  background: transparent;
}

::-webkit-scrollbar-thumb {
  background: var(--color-border-strong);
  border-radius: 4px;
}

::-webkit-scrollbar-thumb:hover {
  background: var(--color-text-muted);
}

/* Focus visible */
:focus-visible {
  outline: 2px solid var(--color-primary);
  outline-offset: 2px;
}

/* App Shell Layout */
.app-shell {
  display: flex;
  height: 100vh;
  overflow: hidden;
}

.brand {
  display: flex;
  align-items: center;
  gap: 10px;
  padding: 10px 12px;
  border-radius: 12px;
  text-decoration: none;
  color: var(--text);
}

.brand:hover {
  background: color-mix(in oklab, var(--surface) 85%, var(--accent) 15%);
}

.brand-mark {
  border-radius: 10px;
  box-shadow: var(--shadow-1);
  flex: 0 0 auto;
}

.brand-name {
  font-family: var(--font-ar);
  font-weight: 700;
  letter-spacing: 0;
  line-height: 1;
  font-size: 16px;
}

.sidebar {
  width: var(--sidebar-width);
  background: var(--color-bg-elevated);
  border-right: 1px solid var(--color-border);
  display: flex;
  flex-direction: column;
  flex-shrink: 0;
}

.sidebar-header {
  padding: var(--space-4) var(--space-5);
  border-bottom: 1px solid var(--color-border);
}

.sidebar-logo {
  font-size: var(--font-size-lg);
  font-weight: var(--font-weight-semibold);
  color: var(--color-text);
}

.sidebar-nav {
  flex: 1;
  padding: var(--space-3) var(--space-3);
  overflow-y: auto;
}

.sidebar-footer {
  padding: var(--space-3);
  border-top: 1px solid var(--color-border);
}

/* Sidebar Collapsed State */
.sidebar.collapsed {
  width: 64px;
}

.sidebar.collapsed .sidebar-header {
  padding: var(--space-3);
  justify-content: center;
}

.sidebar.collapsed .brand {
  padding: var(--space-2);
  justify-content: center;
}

/* Sidebar Header with collapse toggle */
.sidebar-header {
  display: flex;
  align-items: center;
  justify-content: space-between;
}

.sidebar-collapse-toggle {
  display: flex;
  align-items: center;
  justify-content: center;
  width: 28px;
  height: 28px;
  border-radius: var(--radius-md);
  color: var(--color-text-muted);
  flex-shrink: 0;
  transition: all var(--transition-fast);
}

.sidebar-collapse-toggle:hover {
  background: var(--color-bg-hover);
  color: var(--color-text);
}

.sidebar-collapse-toggle .nav-icon {
  width: 16px;
  height: 16px;
  transition: transform var(--transition-fast);
}

.sidebar-collapse-toggle .nav-icon.rotated {
  transform: rotate(180deg);
}

.sidebar.collapsed .sidebar-collapse-toggle {
  position: absolute;
  right: var(--space-2);
  top: var(--space-4);
}

/* Profile Switcher Area */
.sidebar-profile {
  padding: 0 var(--space-3);
  margin-bottom: var(--space-2);
}

.sidebar.collapsed .sidebar-profile {
  padding: 0 var(--space-2);
}

/* Nav Sections */
.nav-section {
  margin-bottom: var(--space-3);
}

.nav-section-header {
  padding: var(--space-2) var(--space-3);
  font-size: var(--font-size-xs);
  font-weight: var(--font-weight-semibold);
  color: var(--color-text-muted);
  text-transform: uppercase;
  letter-spacing: 0.05em;
}

.nav-section-items {
  display: flex;
  flex-direction: column;
  gap: 2px;
}

.sidebar.collapsed .nav-section-header {
  display: none;
}

/* Nav Item Updates */
.nav-item {
  position: relative;
}

.nav-item-rail {
  position: absolute;
  inset-inline-start: 0;
  top: 4px;
  bottom: 4px;
  width: 3px;
  background: var(--color-primary);
  border-radius: 0 2px 2px 0;
}

[dir="rtl"] .nav-item-rail {
  border-radius: 2px 0 0 2px;
}

.nav-item-icon-wrapper {
  position: relative;
  display: flex;
  align-items: center;
  justify-content: center;
  flex-shrink: 0;
}

.nav-item-label {
  flex: 1;
  min-width: 0;
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
}

.nav-item-dot {
  position: absolute;
  top: -2px;
  inset-inline-end: -2px;
  width: 8px;
  height: 8px;
  background: var(--color-primary);
  border-radius: 50%;
  border: 2px solid var(--color-bg-elevated);
}

.sidebar.collapsed .nav-item {
  justify-content: center;
  padding: var(--space-2);
}

.sidebar.collapsed .nav-item .nav-item-label {
  display: none;
}

.sidebar.collapsed .update-indicator {
  display: none;
}

/* New Action Section */
.new-action-section {
  position: relative;
  padding: 0 var(--space-3) var(--space-3);
}

.sidebar.collapsed .new-action-section {
  padding: 0 var(--space-2) var(--space-3);
}

.new-action-btn {
  display: flex;
  align-items: center;
  justify-content: center;
  gap: var(--space-2);
  width: 100%;
  padding: var(--space-2) var(--space-3);
  background: var(--color-primary-light);
  border: 1px solid transparent;
  border-radius: var(--radius-md);
  color: var(--color-primary);
  font-size: var(--font-size-md);
  font-weight: var(--font-weight-medium);
  transition: all var(--transition-fast);
}

.new-action-btn:hover {
  background: var(--color-primary);
  color: var(--on-accent, white);
}

.new-action-btn.active {
  background: var(--color-primary);
  color: var(--on-accent, white);
}

.new-action-btn .nav-icon {
  width: 18px;
  height: 18px;
}

.new-action-label {
  flex: 1;
  text-align: start;
}

.sidebar.collapsed .new-action-btn {
  padding: var(--space-2);
}

.sidebar.collapsed .new-action-label {
  display: none;
}

/* New Action Menu */
.new-action-menu {
  position: absolute;
  top: 100%;
  inset-inline-start: var(--space-3);
  inset-inline-end: var(--space-3);
  margin-top: var(--space-1);
  background: var(--color-bg-elevated);
  border: 1px solid var(--color-border);
  border-radius: var(--radius-lg);
  box-shadow: var(--shadow-lg);
  z-index: 100;
  padding: var(--space-2);
  min-width: 180px;
}

.new-action-menu.collapsed-menu {
  inset-inline-start: 100%;
  inset-inline-end: auto;
  margin-inline-start: var(--space-2);
  margin-top: calc(-1 * var(--space-8));
}

.new-action-menu-item {
  display: flex;
  align-items: center;
  gap: var(--space-3);
  width: 100%;
  padding: var(--space-2) var(--space-3);
  border-radius: var(--radius-md);
  font-size: var(--font-size-md);
  color: var(--color-text);
  text-align: start;
  transition: all var(--transition-fast);
}

.new-action-menu-item:hover {
  background: var(--color-bg-hover);
}

.new-action-menu-item .nav-icon {
  width: 18px;
  height: 18px;
  color: var(--color-text-muted);
}

/* Sidebar Footer Updates */
.sidebar-footer .nav-section-header {
  padding-top: var(--space-3);
}

.sidebar.collapsed .sidebar-footer .nav-section-header {
  display: none;
}

/* Expand Toggle (visible only when collapsed) */
.sidebar-expand-toggle {
  position: absolute;
  bottom: var(--space-4);
  left: 50%;
  transform: translateX(-50%);
  display: flex;
  align-items: center;
  justify-content: center;
  width: 40px;
  height: 40px;
  border-radius: var(--radius-full);
  background: var(--color-accent);
  color: white;
  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.15);
  cursor: pointer;
  transition: all var(--transition-fast);
  z-index: 10;
}

.sidebar-expand-toggle:hover {
  background: var(--color-accent-hover);
  transform: translateX(-50%) scale(1.05);
  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.2);
}

.sidebar-expand-toggle .nav-icon {
  width: 18px;
  height: 18px;
}

.sidebar-profile-switcher {
  margin-bottom: var(--space-2);
}

.nav-item {
  display: flex;
  align-items: center;
  gap: var(--space-3);
  padding: var(--space-2) var(--space-3);
  border-radius: var(--radius-md);
  color: var(--color-text-secondary);
  font-size: var(--font-size-md);
  font-weight: var(--font-weight-medium);
  transition: all var(--transition-fast);
  text-decoration: none;
}

.nav-item:hover {
  background: var(--color-bg-hover);
  color: var(--color-text);
  text-decoration: none;
}

.nav-item.active {
  background: var(--color-primary-light);
  color: var(--color-primary);
}

.nav-icon {
  width: 20px;
  height: 20px;
  flex-shrink: 0;
}

.main-content {
  flex: 1;
  display: flex;
  flex-direction: column;
  overflow: hidden;
}

.topbar {
  height: var(--topbar-height);
  background: var(--color-bg-elevated);
  border-bottom: 1px solid var(--color-border);
  display: flex;
  align-items: center;
  justify-content: space-between;
  padding: 0 var(--space-6);
  flex-shrink: 0;
}

.topbar-left {
  display: flex;
  align-items: center;
  gap: var(--space-4);
}

.topbar-title {
  font-size: var(--font-size-xl);
  font-weight: var(--font-weight-semibold);
}

.topbar-right {
  display: flex;
  align-items: center;
  gap: var(--space-3);
}

.breadcrumbs {
  display: flex;
  align-items: center;
  gap: var(--space-2);
  font-size: var(--font-size-sm);
  color: var(--color-text-muted);
}

.breadcrumb-separator {
  color: var(--color-border-strong);
}

.breadcrumb-link {
  color: var(--color-text-muted);
}

.breadcrumb-link:hover {
  color: var(--color-primary);
}

.breadcrumb-current {
  color: var(--color-text);
  font-weight: var(--font-weight-medium);
}

.page-content {
  flex: 1;
  overflow-y: auto;
  padding: var(--space-6);
}

/* Filters Row */
.filters-row {
  display: flex;
  align-items: center;
  gap: var(--space-3);
  margin-bottom: var(--space-5);
  flex-wrap: wrap;
}

.filter-group {
  display: flex;
  align-items: center;
  gap: var(--space-2);
}

/* Search Input */
.search-input {
  display: flex;
  align-items: center;
  gap: var(--space-2);
  background: var(--color-bg-elevated);
  border: 1px solid var(--color-border);
  border-radius: var(--radius-md);
  padding: var(--space-2) var(--space-3);
  min-width: 200px;
}

.search-input input {
  border: none;
  background: none;
  flex: 1;
  min-width: 0;
}

.search-input input::placeholder {
  color: var(--color-text-muted);
}

/* Segment Control */
.segment-control {
  display: flex;
  background: var(--color-bg);
  border: 1px solid var(--color-border);
  border-radius: var(--radius-md);
  padding: 2px;
}

.segment-button {
  padding: var(--space-1) var(--space-3);
  border-radius: var(--radius-sm);
  font-size: var(--font-size-sm);
  font-weight: var(--font-weight-medium);
  color: var(--color-text-secondary);
  transition: all var(--transition-fast);
}

.segment-button:hover {
  color: var(--color-text);
}

.segment-button.active {
  background: var(--color-bg-elevated);
  color: var(--color-text);
  box-shadow: var(--shadow-sm);
}

/* Select */
.select {
  padding: var(--space-2) var(--space-3);
  background: var(--color-bg-elevated);
  border: 1px solid var(--color-border);
  border-radius: var(--radius-md);
  font-size: var(--font-size-sm);
  color: var(--color-text);
  cursor: pointer;
  min-width: 120px;
}

.select:hover {
  border-color: var(--color-border-strong);
}

/* Input */
.input {
  padding: var(--space-2) var(--space-3);
  background: var(--color-bg-elevated);
  border: 1px solid var(--color-border);
  border-radius: var(--radius-md);
  font-size: var(--font-size-base);
  color: var(--color-text);
  width: 100%;
}

.input:hover {
  border-color: var(--color-border-strong);
}

.input:focus {
  border-color: var(--color-primary);
  box-shadow: 0 0 0 3px var(--color-primary-light);
}

.input-error {
  border-color: var(--color-danger);
}

.input-error:focus {
  box-shadow: 0 0 0 3px var(--color-danger-light);
}

/* Textarea */
.textarea {
  padding: var(--space-3);
  background: var(--color-bg-elevated);
  border: 1px solid var(--color-border);
  border-radius: var(--radius-md);
  font-size: var(--font-size-base);
  color: var(--color-text);
  width: 100%;
  min-height: 80px;
  resize: vertical;
}

.textarea:hover {
  border-color: var(--color-border-strong);
}

.textarea:focus {
  border-color: var(--color-primary);
  box-shadow: 0 0 0 3px var(--color-primary-light);
}

/* Form */
.form-group {
  margin-bottom: var(--space-4);
}

.form-label {
  display: block;
  font-size: var(--font-size-sm);
  font-weight: var(--font-weight-medium);
  color: var(--color-text-secondary);
  margin-bottom: var(--space-1);
}

.form-error {
  font-size: var(--font-size-sm);
  color: var(--color-danger);
  margin-top: var(--space-1);
}

.form-row {
  display: grid;
  grid-template-columns: repeat(2, 1fr);
  gap: var(--space-4);
}

/* Buttons */
.btn {
  display: inline-flex;
  align-items: center;
  justify-content: center;
  gap: var(--space-2);
  padding: var(--space-2) var(--space-4);
  border-radius: var(--radius-md);
  font-size: var(--font-size-base);
  font-weight: var(--font-weight-medium);
  transition: all var(--transition-fast);
  white-space: nowrap;
}

.btn-primary {
  background: var(--accent-solid);
  color: var(--on-accent);
  border: 1px solid var(--btn-primary-border);
  box-shadow: var(--btn-primary-shadow);
}

.btn-primary:hover {
  background: var(--accent-solid-hover);
  border-color: var(--btn-primary-border-hover);
  box-shadow: var(--btn-primary-shadow-hover);
}

.btn-secondary {
  background: var(--color-bg);
  border: 1px solid var(--color-border);
  color: var(--color-text);
}

.btn-secondary:hover {
  background: var(--color-bg-hover);
  border-color: var(--color-border-strong);
}

.btn-danger {
  background: var(--color-danger);
  color: white;
}

.btn-danger:hover {
  background: var(--error-hover);
}

.btn-ghost {
  background: transparent;
  color: var(--color-text-secondary);
}

.btn-ghost:hover {
  background: var(--color-bg-hover);
  color: var(--color-text);
}

.btn-sm {
  height: 32px;
  min-width: 32px;
  padding: 0 var(--space-3);
  font-size: var(--font-size-sm);
}

.btn-lg {
  height: 44px;
  min-width: 44px;
  padding: 0 var(--space-5);
  font-size: var(--font-size-md);
}

/* Add Menu */
.add-menu-container {
  position: relative;
}

.add-menu {
  position: absolute;
  top: calc(100% + var(--space-2));
  right: 0;
  background: var(--color-bg-elevated);
  border: 1px solid var(--color-border);
  border-radius: var(--radius-lg);
  box-shadow: var(--shadow-lg);
  min-width: 180px;
  padding: var(--space-2);
  z-index: 100;
}

.add-menu-item {
  display: flex;
  align-items: center;
  gap: var(--space-3);
  width: 100%;
  padding: var(--space-2) var(--space-3);
  border-radius: var(--radius-md);
  font-size: var(--font-size-md);
  color: var(--color-text);
  text-align: left;
}

.add-menu-item:hover {
  background: var(--color-bg-hover);
}

.add-menu-divider {
  height: 1px;
  background: var(--color-border);
  margin: var(--space-2) 0;
}

/* Cards */
.card {
  background: var(--color-bg-elevated);
  border: 1px solid var(--color-border);
  border-radius: var(--radius-lg);
  padding: var(--space-4);
}

.card-header {
  display: flex;
  align-items: center;
  justify-content: space-between;
  margin-bottom: var(--space-4);
}

.card-title {
  font-size: var(--font-size-md);
  font-weight: var(--font-weight-semibold);
}

/* KPI Cards */
.kpi-row {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
  gap: var(--space-4);
  margin-bottom: var(--space-6);
}

.kpi-card {
  background: var(--color-bg-elevated);
  border: 1px solid var(--color-border);
  border-radius: var(--radius-lg);
  padding: var(--space-4);
}

.kpi-label {
  font-size: var(--font-size-sm);
  color: var(--color-text-muted);
  margin-bottom: var(--space-1);
}

.kpi-value {
  font-size: var(--font-size-xl);
  font-weight: var(--font-weight-semibold);
}

.kpi-value.positive {
  color: var(--color-success);
}
.kpi-value.negative {
  color: var(--color-danger);
}
.kpi-value.warning {
  color: var(--color-warning);
}

/* Clickable KPI Cards */
.kpi-card.clickable {
  cursor: pointer;
  transition: transform var(--transition-fast), box-shadow var(--transition-fast);
  text-align: inherit;
  font: inherit;
  width: 100%;
}

.kpi-card.clickable:hover {
  transform: translateY(-2px);
  box-shadow: var(--shadow-md);
  border-color: var(--color-primary-light);
}

.kpi-card.clickable:focus-visible {
  outline: 2px solid var(--color-primary);
  outline-offset: 2px;
}

.kpi-card.clickable:active {
  transform: translateY(0);
}

/* Period Control */
.period-control {
  display: flex;
  align-items: center;
  gap: var(--space-3);
}

.year-stepper {
  display: flex;
  align-items: center;
  gap: var(--space-2);
  background: var(--color-bg);
  border: 1px solid var(--color-border);
  border-radius: var(--radius-md);
  padding: var(--space-1);
}

.year-display {
  font-weight: var(--font-weight-medium);
  min-width: 60px;
  text-align: center;
}

/* Sort Icon */
.sort-icon {
  margin-inline-start: var(--space-1);
  opacity: 0.7;
  font-size: var(--font-size-xs);
}

/* Data Table */
.data-table {
  background: var(--color-bg-elevated);
  border: 1px solid var(--color-border);
  border-radius: var(--radius-lg);
  overflow-x: auto;
}

/* Ensure first row header cells have rounded top corners */
.data-table th:first-child {
  border-top-left-radius: calc(var(--radius-lg) - 1px);
}

.data-table th:last-child {
  border-top-right-radius: calc(var(--radius-lg) - 1px);
}

/* Ensure last row cells have rounded bottom corners */
.data-table tr:last-child td:first-child {
  border-bottom-left-radius: calc(var(--radius-lg) - 1px);
}

.data-table tr:last-child td:last-child {
  border-bottom-right-radius: calc(var(--radius-lg) - 1px);
}

.data-table table {
  width: 100%;
}

.data-table th {
  background: var(--color-bg);
  font-size: var(--font-size-sm);
  font-weight: var(--font-weight-medium);
  color: var(--color-text-secondary);
  padding: var(--space-3) var(--space-4);
  border-bottom: 1px solid var(--color-border);
  white-space: nowrap;
}

.data-table th.sortable {
  cursor: pointer;
  user-select: none;
}

.data-table th.sortable:hover {
  color: var(--color-text);
}

.data-table td {
  padding: var(--space-3) var(--space-4);
  border-bottom: 1px solid var(--color-border);
  font-size: var(--font-size-base);
}

.data-table tr:last-child td {
  border-bottom: none;
}

.data-table tr:hover td {
  background: var(--color-bg-hover);
}

.data-table tr.clickable {
  cursor: pointer;
}

.data-table .amount-cell {
  text-align: right;
  font-family: var(--font-mono);
  font-size: var(--font-size-sm);
}

.data-table .amount-positive {
  color: var(--color-success);
}
.data-table .amount-negative {
  color: var(--color-expense);
}

/* Status Badge */
.status-badge {
  display: inline-flex;
  align-items: center;
  gap: var(--space-1);
  padding: 2px var(--space-2);
  border-radius: var(--radius-sm);
  font-size: var(--font-size-xs);
  font-weight: var(--font-weight-medium);
}

.status-badge.paid {
  background: var(--color-success-light);
  color: var(--color-success);
}

.status-badge.unpaid {
  background: var(--color-warning-light);
  color: var(--color-warning);
}

.status-badge.overdue {
  background: var(--color-danger-light);
  color: var(--color-danger);
}

/* Type Badge */
.type-badge {
  display: inline-flex;
  align-items: center;
  padding: 2px var(--space-2);
  border-radius: var(--radius-sm);
  font-size: var(--font-size-xs);
  font-weight: var(--font-weight-medium);
}

.type-badge.income {
  background: var(--color-success-light);
  color: var(--color-success);
}

.type-badge.expense {
  background: var(--color-bg);
  color: var(--color-text-secondary);
}

.type-badge.receivable {
  background: var(--color-warning-light);
  color: var(--color-warning);
}

/* Attention List */
.attention-list {
  background: var(--color-bg-elevated);
  border: 1px solid var(--color-border);
  border-radius: var(--radius-lg);
}

.attention-header {
  padding: var(--space-4);
  border-bottom: 1px solid var(--color-border);
}

.attention-title {
  font-size: var(--font-size-md);
  font-weight: var(--font-weight-semibold);
  color: var(--color-danger);
}

.attention-item {
  display: flex;
  align-items: center;
  justify-content: space-between;
  padding: var(--space-3) var(--space-4);
  border-bottom: 1px solid var(--color-border);
}

.attention-item:last-child {
  border-bottom: none;
}

.attention-item:hover {
  background: var(--color-bg-hover);
}

.attention-info {
  display: flex;
  flex-direction: column;
  gap: 2px;
}

.attention-client {
  font-weight: var(--font-weight-medium);
}

.attention-meta {
  font-size: var(--font-size-sm);
  color: var(--color-text-muted);
}

.attention-amount {
  font-family: var(--font-mono);
  font-weight: var(--font-weight-medium);
}

/* Drawer */
.drawer-overlay {
  position: fixed;
  inset: 0;
  background: rgba(0, 0, 0, 0.3);
  z-index: 200;
  animation: fadeIn var(--transition-fast);
}

@keyframes fadeIn {
  from {
    opacity: 0;
  }
  to {
    opacity: 1;
  }
}

.drawer {
  position: fixed;
  top: 0;
  right: 0;
  bottom: 0;
  width: var(--drawer-width);
  background: var(--color-bg-elevated);
  box-shadow: var(--shadow-drawer);
  z-index: 201;
  display: flex;
  flex-direction: column;
  animation: slideIn var(--transition-normal);
}

@keyframes slideIn {
  from {
    transform: translateX(100%);
  }
  to {
    transform: translateX(0);
  }
}

.drawer-header {
  display: flex;
  align-items: center;
  justify-content: space-between;
  padding: var(--space-4) var(--space-5);
  border-bottom: 1px solid var(--color-border);
}

.drawer-title {
  font-size: var(--font-size-lg);
  font-weight: var(--font-weight-semibold);
}

.drawer-close {
  width: 32px;
  height: 32px;
  display: flex;
  align-items: center;
  justify-content: center;
  border-radius: var(--radius-md);
  color: var(--color-text-muted);
}

.drawer-close:hover {
  background: var(--color-bg-hover);
  color: var(--color-text);
}

.drawer-body {
  flex: 1;
  overflow-y: auto;
  padding: var(--space-5);
}

.drawer-footer {
  display: flex;
  align-items: center;
  justify-content: space-between;
  padding: var(--space-4) var(--space-5);
  border-top: 1px solid var(--color-border);
  background: var(--color-bg);
}

.drawer-footer-left {
  display: flex;
  gap: var(--space-3);
}

.drawer-footer-right {
  display: flex;
  gap: var(--space-3);
}

/* Document Guard - No Profile State */
.document-guard {
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  text-align: center;
  padding: var(--space-8) var(--space-4);
  min-height: 300px;
}

.document-guard-icon {
  color: var(--color-accent);
  margin-bottom: var(--space-4);
}

.document-guard-title {
  font-size: var(--font-size-lg);
  font-weight: var(--font-weight-semibold);
  color: var(--color-text);
  margin: 0 0 var(--space-2) 0;
}

.document-guard-description {
  font-size: var(--font-size-sm);
  color: var(--color-muted);
  margin: 0 0 var(--space-5) 0;
  max-width: 280px;
}

/* Type Selector in Drawer */
.type-selector {
  display: grid;
  grid-template-columns: repeat(3, 1fr);
  gap: var(--space-2);
  margin-bottom: var(--space-5);
}

.type-selector-btn {
  padding: var(--space-3);
  border: 2px solid var(--color-border);
  border-radius: var(--radius-md);
  text-align: center;
  transition: all var(--transition-fast);
}

.type-selector-btn:hover {
  border-color: var(--color-border-strong);
}

.type-selector-btn.active {
  border-color: var(--color-primary);
  background: var(--color-primary-light);
}

.type-selector-label {
  font-size: var(--font-size-sm);
  font-weight: var(--font-weight-medium);
  display: block;
}

.type-selector-hint {
  font-size: var(--font-size-xs);
  color: var(--color-text-muted);
  margin-top: 2px;
}

/* Document Type Grid (7 types) */
.document-type-grid {
  display: grid;
  grid-template-columns: repeat(4, 1fr);
  gap: var(--space-2);
  margin-bottom: var(--space-4);
}

.document-type-btn {
  padding: var(--space-2) var(--space-3);
  border: 2px solid var(--color-border);
  border-radius: var(--radius-md);
  font-size: var(--font-size-sm);
  font-weight: var(--font-weight-medium);
  text-align: center;
  transition: all var(--transition-fast);
  white-space: nowrap;
}

.document-type-btn:hover:not(:disabled) {
  border-color: var(--color-border-strong);
}

.document-type-btn.active {
  border-color: var(--color-primary);
  background: var(--color-primary-light);
}

.document-type-btn:disabled {
  opacity: 0.5;
  cursor: not-allowed;
}

/* Form Sections */
.form-section {
  margin: var(--space-5) 0;
  padding: var(--space-4);
  background: var(--color-bg);
  border: 1px solid var(--color-border);
  border-radius: var(--radius-md);
}

.form-section-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: var(--space-3);
}

.form-section-title {
  font-size: var(--font-size-md);
  font-weight: var(--font-weight-semibold);
}

/* Line Items Editor */
.line-item-row {
  display: flex;
  gap: var(--space-2);
  align-items: center;
  margin-bottom: var(--space-2);
}

.line-item-main {
  flex: 3;
}

.line-item-qty {
  width: 70px;
}

.line-item-rate {
  width: 100px;
}

.line-item-total {
  width: 100px;
  text-align: right;
  font-weight: var(--font-weight-medium);
  font-size: var(--font-size-sm);
  color: var(--color-text-secondary);
}

/* Totals Section */
.totals-section {
  margin-top: var(--space-4);
  padding: var(--space-4);
  background: var(--surface);
  border-radius: var(--radius-md);
}

.totals-row {
  display: flex;
  justify-content: space-between;
  padding: var(--space-2) 0;
  font-size: var(--font-size-md);
}

.totals-row.totals-total {
  border-top: 1px solid var(--color-border);
  margin-top: var(--space-2);
  padding-top: var(--space-3);
  font-weight: var(--font-weight-semibold);
  font-size: var(--font-size-lg);
}

/* Payment Row */
.payment-row {
  display: flex;
  gap: var(--space-2);
  align-items: center;
  margin-bottom: var(--space-2);
}

.payment-method {
  width: 140px;
}

.payment-amount {
  width: 120px;
}

.payment-date {
  flex: 1;
}

/* Small button variant */
.btn-sm {
  padding: var(--space-1) var(--space-3);
  font-size: var(--font-size-sm);
}

/* Icon button */
.btn-icon {
  width: 32px;
  height: 32px;
  padding: 0;
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: var(--font-size-lg);
}

/* Warning button */
.btn-warning {
  background: var(--color-warning);
  color: white;
}

.btn-warning:hover {
  background: var(--color-warning);
  opacity: 0.9;
}

/* Alert styles */
.alert {
  padding: var(--space-3) var(--space-4);
  border-radius: var(--radius-md);
  font-size: var(--font-size-sm);
}

.alert-info {
  background: var(--color-primary-light);
  color: var(--color-primary);
  border: 1px solid var(--color-primary);
}

/* Tabs */
.tabs {
  border-bottom: 1px solid var(--color-border);
  margin-bottom: var(--space-5);
}

.tabs-list {
  display: flex;
  gap: var(--space-1);
}

.tab {
  padding: var(--space-3) var(--space-4);
  font-size: var(--font-size-md);
  font-weight: var(--font-weight-medium);
  color: var(--color-text-secondary);
  border-bottom: 2px solid transparent;
  margin-bottom: -1px;
  transition: all var(--transition-fast);
}

.tab:hover {
  color: var(--color-text);
}

.tab.active {
  color: var(--color-primary);
  border-bottom-color: var(--color-primary);
}

/* Inline Stats */
.inline-stats {
  display: flex;
  gap: var(--space-6);
}

.inline-stat {
  display: flex;
  flex-direction: column;
}

.inline-stat-label {
  font-size: var(--font-size-sm);
  color: var(--color-text-muted);
}

.inline-stat-value {
  font-size: var(--font-size-md);
  font-weight: var(--font-weight-semibold);
}

/* Empty State */
.empty-state {
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  padding: var(--space-12);
  text-align: center;
}

.empty-state-title {
  font-size: var(--font-size-lg);
  font-weight: var(--font-weight-semibold);
  margin-bottom: var(--space-2);
}

.empty-state-description {
  color: var(--color-text-muted);
  margin-bottom: var(--space-4);
}

/* Note indicator */
.note-indicator {
  width: 6px;
  height: 6px;
  background: var(--color-primary);
  border-radius: 50%;
  display: inline-block;
}

/* Document indicator */
.doc-indicator {
  color: var(--color-primary);
  cursor: pointer;
  display: inline-flex;
  align-items: center;
}

.doc-indicator:hover {
  color: var(--color-primary-hover);
}

/* Responsive Table - Compact Mode */
.date-cell-compact {
  display: flex;
  align-items: center;
  gap: var(--space-1);
}

.status-dot {
  width: 6px;
  height: 6px;
  border-radius: 50%;
  flex-shrink: 0;
}

.status-dot[data-status="paid"] {
  background: var(--color-success);
}

.status-dot[data-status="unpaid"] {
  background: var(--color-warning);
}

.status-dot[data-status="overdue"] {
  background: var(--color-danger);
}

@media (max-width: 768px) {
  .data-table .text-sm-responsive {
    font-size: var(--font-size-xs);
  }
}

/* Detail Page Layout */
.detail-header {
  display: flex;
  justify-content: space-between;
  align-items: flex-start;
  margin-bottom: var(--space-5);
  padding-bottom: var(--space-5);
  border-bottom: 1px solid var(--color-border);
}

.detail-header-info {
  flex: 1;
}

.detail-header-meta {
  display: flex;
  align-items: center;
  gap: var(--space-3);
  margin-bottom: var(--space-3);
}

.detail-header-stats {
  display: flex;
  gap: var(--space-6);
}

.detail-header-actions {
  display: flex;
  gap: var(--space-2);
  align-items: center;
}

/* Detail Grid */
.detail-grid {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
  gap: var(--space-4);
}

.detail-card {
  background: var(--surface);
  border: 1px solid var(--color-border);
  border-radius: var(--radius-lg);
  padding: var(--space-4);
}

.detail-card h3 {
  font-size: var(--font-size-md);
  font-weight: var(--font-weight-semibold);
  margin-bottom: var(--space-3);
  color: var(--color-text);
}

.detail-card-wide {
  grid-column: 1 / -1;
}

/* Detail List (dl) */
.detail-list {
  display: grid;
  grid-template-columns: auto 1fr;
  gap: var(--space-2) var(--space-4);
  font-size: var(--font-size-sm);
}

.detail-list dt {
  color: var(--color-text-muted);
}

.detail-list dd {
  color: var(--color-text);
}

/* Detail Table */
.detail-table {
  width: 100%;
  font-size: var(--font-size-sm);
}

.detail-table th,
.detail-table td {
  padding: var(--space-2);
  border-bottom: 1px solid var(--color-border);
}

.detail-table th {
  font-weight: var(--font-weight-medium);
  color: var(--color-text-muted);
}

/* Detail Notes */
.detail-notes {
  color: var(--color-text-secondary);
  white-space: pre-wrap;
  font-size: var(--font-size-sm);
}

/* PDF Preview Container */
.pdf-preview-container {
  background: var(--color-bg);
  border: 1px solid var(--color-border);
  border-radius: var(--radius-lg);
  overflow: hidden;
}

/* Success button variant */
.btn-success {
  background: var(--color-success);
  color: white;
  display: inline-flex;
  align-items: center;
  gap: var(--space-2);
}

.btn-success:hover {
  opacity: 0.9;
}

/* Update indicator (sidebar) */
.update-indicator {
  width: 8px;
  height: 8px;
  background: var(--color-primary);
  border-radius: 50%;
  margin-inline-start: auto;
  flex-shrink: 0;
}

/* Update available banner (settings) */
.update-banner {
  display: flex;
  align-items: center;
  justify-content: space-between;
  padding: var(--space-4);
  background: var(--color-primary-light);
  border: 1px solid var(--color-primary);
  border-radius: var(--radius-lg);
  margin-bottom: var(--space-4);
}

.update-banner-content {
  display: flex;
  flex-direction: column;
  gap: var(--space-1);
}

.update-banner-title {
  font-weight: var(--font-weight-semibold);
  color: var(--color-primary);
}

.update-banner-versions {
  font-size: var(--font-size-sm);
  color: var(--color-text-secondary);
}

.update-banner-version {
  font-family: var(--font-mono);
}

/* Reports Layout */
.reports-layout {
  display: grid;
  grid-template-columns: 240px 1fr;
  gap: var(--space-6);
  height: 100%;
}

.reports-sidebar {
  background: var(--color-bg-elevated);
  border: 1px solid var(--color-border);
  border-radius: var(--radius-lg);
  padding: var(--space-4);
}

.reports-sidebar-title {
  font-size: var(--font-size-sm);
  font-weight: var(--font-weight-semibold);
  color: var(--color-text-muted);
  text-transform: uppercase;
  letter-spacing: 0.05em;
  margin-bottom: var(--space-3);
}

.report-preset {
  display: block;
  width: 100%;
  padding: var(--space-2) var(--space-3);
  border-radius: var(--radius-md);
  font-size: var(--font-size-md);
  color: var(--color-text-secondary);
  text-align: left;
  transition: all var(--transition-fast);
}

.report-preset:hover {
  background: var(--color-bg-hover);
  color: var(--color-text);
}

.report-preset.active {
  background: var(--color-primary-light);
  color: var(--color-primary);
}

.reports-content {
  background: var(--color-bg-elevated);
  border: 1px solid var(--color-border);
  border-radius: var(--radius-lg);
  padding: var(--space-5);
}

/* Settings */
.settings-section {
  margin-bottom: var(--space-8);
}

.settings-section-title {
  font-size: var(--font-size-lg);
  font-weight: var(--font-weight-semibold);
  margin-bottom: var(--space-4);
  padding-bottom: var(--space-3);
  border-bottom: 1px solid var(--color-border);
}

.settings-row {
  display: flex;
  align-items: center;
  justify-content: space-between;
  padding: var(--space-3) 0;
}

.settings-label {
  font-weight: var(--font-weight-medium);
}

.settings-description {
  font-size: var(--font-size-sm);
  color: var(--color-text-muted);
  margin-top: 2px;
}

.settings-section-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: var(--space-4);
  padding-bottom: var(--space-3);
  border-bottom: 1px solid var(--color-border);
}

.settings-section-header .settings-section-title {
  margin-bottom: 0;
  padding-bottom: 0;
  border-bottom: none;
}

/* Business Profiles List */
.business-profiles-list {
  display: flex;
  flex-direction: column;
  gap: var(--space-3);
}

.business-profile-item {
  display: flex;
  justify-content: space-between;
  align-items: center;
  padding: var(--space-3);
  background: var(--surface);
  border: 1px solid var(--color-border);
  border-radius: var(--radius-md);
}

.business-profile-info {
  display: flex;
  align-items: center;
  gap: var(--space-3);
}

.business-profile-logo {
  width: 40px;
  height: 40px;
  object-fit: contain;
  border-radius: var(--radius-sm);
}

.business-profile-details {
  display: flex;
  flex-direction: column;
}

.business-profile-name {
  font-weight: var(--font-weight-medium);
}

.business-profile-meta {
  display: flex;
  align-items: center;
}

.business-profile-actions {
  display: flex;
  gap: var(--space-1);
}

/* Loading */
.loading {
  display: flex;
  align-items: center;
  justify-content: center;
  padding: var(--space-8);
  color: var(--color-text-muted);
}

.spinner {
  width: 24px;
  height: 24px;
  border: 2px solid var(--color-border);
  border-top-color: var(--color-primary);
  border-radius: 50%;
  animation: spin 0.8s linear infinite;
}

@keyframes spin {
  to {
    transform: rotate(360deg);
  }
}

/* ============================================
   RTL (Right-to-Left) Support
   ============================================ */

/* Icon flipping for directional icons (chevrons, arrows) */
.icon-flip {
  display: inline-block;
}

[dir="rtl"] .icon-flip {
  transform: scaleX(-1);
}

/* Sidebar border - use logical properties */
[dir="rtl"] .sidebar {
  border-right: none;
  border-left: 1px solid var(--color-border);
}

/* Table text alignment - use logical alignment */
[dir="rtl"] th,
[dir="rtl"] td {
  text-align: right;
}

/* Amount cells should always align to end */
[dir="rtl"] .data-table .amount-cell {
  text-align: left;
}

/* RTL: Flip border-radius for table corners */
[dir="rtl"] .data-table th:first-child {
  border-top-left-radius: 0;
  border-top-right-radius: calc(var(--radius-lg) - 1px);
}

[dir="rtl"] .data-table th:last-child {
  border-top-right-radius: 0;
  border-top-left-radius: calc(var(--radius-lg) - 1px);
}

[dir="rtl"] .data-table tr:last-child td:first-child {
  border-bottom-left-radius: 0;
  border-bottom-right-radius: calc(var(--radius-lg) - 1px);
}

[dir="rtl"] .data-table tr:last-child td:last-child {
  border-bottom-right-radius: 0;
  border-bottom-left-radius: calc(var(--radius-lg) - 1px);
}

/* Add menu dropdown - flip positioning */
[dir="rtl"] .add-menu {
  right: auto;
  left: 0;
}

/* Add menu item text alignment */
[dir="rtl"] .add-menu-item {
  text-align: right;
}

/* Drawer - slide from left in RTL */
[dir="rtl"] .drawer {
  right: auto;
  left: 0;
  box-shadow: 4px 0 15px rgba(0, 0, 0, 0.1);
  animation: slideInRTL var(--transition-normal);
}

@keyframes slideInRTL {
  from {
    transform: translateX(-100%);
  }
  to {
    transform: translateX(0);
  }
}

/* Reports sidebar text alignment */
[dir="rtl"] .report-preset {
  text-align: right;
}

/* Form labels alignment */
[dir="rtl"] .form-label {
  text-align: right;
}

/* Breadcrumb separator - use CSS content for flip */
[dir="rtl"] .breadcrumb-separator {
  transform: scaleX(-1);
  display: inline-block;
}

/* Type selector in drawer */
[dir="rtl"] .type-selector-btn {
  text-align: center;
}

/* Tab alignment */
[dir="rtl"] .tab {
  text-align: right;
}

/* Settings row alignment handled by flexbox - no change needed */

/* Note indicator margin */
[dir="rtl"] .note-indicator {
  margin-left: 0;
  margin-right: var(--space-1);
}

/* Attention list alignment */
[dir="rtl"] .attention-info {
  text-align: right;
}

/* Inline stats gap - handled by flexbox - no change needed */

/* Search input - keep text direction for input */
[dir="rtl"] .search-input input {
  text-align: right;
}

/* Number inputs should stay LTR for proper digit entry */
[dir="rtl"] input[type="number"],
[dir="rtl"] input[type="tel"],
[dir="rtl"] .num-input {
  direction: ltr;
  text-align: right;
}

/* Currency amounts in inputs should stay LTR */
[dir="rtl"] .amount-input input {
  direction: ltr;
  text-align: right;
}

/* Dark mode RTL drawer shadow */
@media (prefers-color-scheme: dark) {
  [dir="rtl"] .drawer {
    box-shadow: 4px 0 24px rgba(0, 0, 0, 0.4);
  }
}

/* ========================================
   UnifiedAmount Component Styles
   ======================================== */

.unified-amount {
  display: flex;
  flex-direction: column;
  gap: 4px;
}

.unified-amount-kpi {
  display: flex;
  flex-direction: column;
  gap: 4px;
}

.unified-amount-compact {
  display: inline-flex;
  align-items: center;
  gap: 4px;
}

.unified-total {
  display: flex;
  align-items: center;
  gap: 8px;
  font-weight: 600;
}

.unified-amount-kpi .unified-total {
  font-size: 24px;
  font-weight: 700;
}

.unified-amount-compact .unified-total {
  font-weight: 500;
}

.unified-breakdown {
  display: flex;
  align-items: center;
  gap: 6px;
  font-size: 12px;
  color: var(--color-text-muted);
}

.unified-amount-kpi .unified-breakdown {
  font-size: 13px;
}

.breakdown-item {
  white-space: nowrap;
}

.breakdown-currency {
  color: var(--color-text-secondary);
  font-weight: 500;
}

.breakdown-separator {
  color: var(--color-text-muted);
}

.unified-fallback {
  color: var(--color-text-secondary);
}

/* FX Source badges */
.fx-source-badge {
  display: inline-flex;
  align-items: center;
  padding: 2px 6px;
  font-size: 10px;
  font-weight: 500;
  text-transform: uppercase;
  letter-spacing: 0.02em;
  border-radius: 4px;
}

.fx-source-badge.source-live {
  color: var(--color-success);
  background-color: var(--color-success-light);
}

.fx-source-badge.source-cached {
  color: var(--color-warning);
  background-color: var(--color-warning-light);
}

.fx-source-badge.source-none {
  color: var(--color-danger);
  background-color: var(--color-danger-light);
}

.fx-indicator {
  font-size: 10px;
  vertical-align: super;
}

.fx-indicator.source-cached {
  color: var(--color-warning);
}

.fx-indicator.source-none {
  color: var(--color-danger);
}

/* Amount colors for UnifiedAmount */
.unified-amount .amount-positive,
.unified-amount-kpi .amount-positive,
.unified-amount-compact.amount-positive .unified-total {
  color: var(--color-success);
}

.unified-amount .amount-negative,
.unified-amount-kpi .amount-negative,
.unified-amount-compact.amount-negative .unified-total {
  color: var(--color-danger);
}

/* Currency Summary Popup */
.currency-summary-popup {
  position: relative;
  display: inline-flex;
  flex-direction: column;
  gap: 4px;
}

.currency-summary-label {
  font-size: 12px;
  color: var(--text-muted);
  text-transform: uppercase;
  letter-spacing: 0.03em;
}

.currency-summary-main {
  display: inline-flex;
  align-items: center;
  gap: 6px;
}

.currency-summary-amount {
  font-size: 16px;
  font-weight: 600;
}

.currency-summary-amount.large {
  font-size: 24px;
  font-weight: 700;
}

.currency-summary-toggle {
  display: inline-flex;
  align-items: center;
  justify-content: center;
  width: 20px;
  height: 20px;
  padding: 0;
  border: none;
  background: transparent;
  color: var(--text-muted);
  cursor: pointer;
  border-radius: 50%;
  transition: background-color 0.15s, color 0.15s;
}

.currency-summary-toggle:hover {
  background: var(--surface-hover);
  color: var(--text-secondary);
}

.currency-summary-dropdown {
  position: absolute;
  top: 100%;
  inset-inline-start: 0;
  z-index: 100;
  min-width: 180px;
  margin-top: 4px;
  padding: 12px;
  background: var(--surface);
  border: 1px solid var(--border);
  border-radius: 8px;
  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
}

.currency-breakdown-row {
  display: flex;
  justify-content: space-between;
  align-items: center;
  padding: 6px 0;
}

.currency-breakdown-row:not(:last-child) {
  border-bottom: 1px solid var(--border-subtle);
}

.currency-breakdown-label {
  font-size: 13px;
  font-weight: 500;
  color: var(--text-secondary);
}

.currency-breakdown-value {
  font-size: 14px;
  font-weight: 600;
}

.currency-breakdown-rate {
  display: flex;
  flex-wrap: wrap;
  gap: 4px;
  margin-top: 8px;
  padding-top: 8px;
  border-top: 1px solid var(--border);
  font-size: 11px;
  color: var(--text-muted);
}

.currency-breakdown-rate-label {
  font-weight: 500;
}

.currency-breakdown-source {
  opacity: 0.8;
}

.currency-breakdown-source.source-live {
  color: var(--color-success);
}

.currency-breakdown-source.source-cached {
  color: var(--color-warning);
}

/* ========================================
   Retainer Matching Drawer Styles
   ======================================== */

/* Step Progress Indicator */
.matching-steps {
  display: flex;
  align-items: center;
  justify-content: center;
  gap: var(--space-2);
  padding: var(--space-4) 0;
  margin-bottom: var(--space-4);
}

.matching-step-dot {
  width: 10px;
  height: 10px;
  border-radius: 50%;
  background: var(--color-border);
  transition: all var(--transition-fast);
}

.matching-step-dot.active {
  background: var(--color-primary);
  box-shadow: 0 0 0 3px var(--color-primary-light);
}

.matching-step-dot.completed {
  background: var(--color-success);
}

.matching-step-line {
  width: 60px;
  height: 2px;
  background: var(--color-border);
  border-radius: 1px;
}

.matching-step-line.active {
  background: var(--color-primary);
}

/* Matching Step Content */
.matching-step {
  display: flex;
  flex-direction: column;
  gap: var(--space-4);
}

.matching-description {
  font-size: var(--font-size-sm);
  color: var(--color-text-secondary);
  margin: 0;
}

.matching-filters {
  display: flex;
  gap: var(--space-2);
}

.matching-actions {
  display: flex;
  gap: var(--space-2);
}

/* Selected Transaction Context Card */
.matching-context-card {
  display: flex;
  align-items: center;
  justify-content: space-between;
  padding: var(--space-3) var(--space-4);
  background: var(--color-primary-light);
  border: 1px solid var(--color-primary);
  border-radius: var(--radius-md);
  margin-bottom: var(--space-4);
}

.matching-context-info {
  display: flex;
  flex-direction: column;
  gap: 2px;
  min-width: 0;
  flex: 1;
}

.matching-context-title {
  font-weight: var(--font-weight-medium);
  color: var(--color-text);
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
}

.matching-context-meta {
  font-size: var(--font-size-sm);
  color: var(--color-text-secondary);
}

.matching-context-amount {
  font-family: var(--font-mono);
  font-weight: var(--font-weight-semibold);
  color: var(--color-success);
  margin-inline-start: var(--space-3);
  flex-shrink: 0;
}

.matching-context-change {
  margin-inline-start: var(--space-3);
  padding: var(--space-1) var(--space-2);
  font-size: var(--font-size-sm);
  color: var(--color-primary);
  background: transparent;
  border: 1px solid var(--color-primary);
  border-radius: var(--radius-sm);
  cursor: pointer;
  transition: all var(--transition-fast);
}

.matching-context-change:hover {
  background: var(--color-primary);
  color: white;
}

/* Matching List */
.matching-list {
  display: flex;
  flex-direction: column;
  gap: var(--space-2);
}

.matching-section {
  margin-bottom: var(--space-4);
}

.matching-section-title {
  font-size: var(--font-size-sm);
  font-weight: var(--font-weight-semibold);
  color: var(--color-text-secondary);
  text-transform: uppercase;
  letter-spacing: 0.03em;
  margin: 0 0 var(--space-2) 0;
  display: flex;
  align-items: center;
  gap: var(--space-2);
}

.matching-section-title::after {
  content: '';
  flex: 1;
  height: 1px;
  background: var(--color-border);
}

/* Matching Item */
.matching-item {
  display: flex;
  align-items: center;
  justify-content: space-between;
  width: 100%;
  padding: var(--space-3) var(--space-4);
  background: var(--color-bg-elevated);
  border: 1px solid var(--color-border);
  border-radius: var(--radius-md);
  cursor: pointer;
  transition: all var(--transition-fast);
  text-align: start;
}

.matching-item:hover:not(:disabled) {
  border-color: var(--color-primary);
  background: var(--color-bg-hover);
}

.matching-item:focus-visible {
  outline: 2px solid var(--color-primary);
  outline-offset: 2px;
}

.matching-item:disabled {
  opacity: 0.5;
  cursor: not-allowed;
}

.matching-item-suggested {
  border-color: var(--color-primary-light);
  background: color-mix(in oklab, var(--color-bg-elevated) 95%, var(--color-primary) 5%);
}

.matching-item-main {
  display: flex;
  flex-direction: column;
  gap: 2px;
  min-width: 0;
  flex: 1;
}

.matching-item-title {
  font-weight: var(--font-weight-medium);
  color: var(--color-text);
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
}

.matching-item-meta {
  font-size: var(--font-size-sm);
  color: var(--color-text-muted);
}

.matching-item-right {
  display: flex;
  align-items: center;
  gap: var(--space-3);
  flex-shrink: 0;
}

.matching-item-amount {
  font-family: var(--font-mono);
  font-weight: var(--font-weight-medium);
}

.matching-item-amount.amount-positive {
  color: var(--color-success);
}

/* Confidence Badge */
.confidence-badge {
  display: inline-flex;
  align-items: center;
  gap: var(--space-1);
  padding: 2px var(--space-2);
  border-radius: var(--radius-sm);
  font-size: var(--font-size-xs);
  font-weight: var(--font-weight-medium);
  cursor: pointer;
  transition: all var(--transition-fast);
}

.confidence-badge:hover {
  transform: scale(1.02);
}

.confidence-high {
  background: var(--color-success-light);
  color: var(--color-success);
}

.confidence-medium {
  background: var(--color-warning-light);
  color: var(--color-warning);
}

.confidence-low {
  background: var(--color-bg);
  color: var(--color-text-secondary);
  border: 1px solid var(--color-border);
}

/* Score Badge with numeric display */
.score-badge {
  display: inline-flex;
  align-items: center;
  gap: var(--space-1);
  padding: 2px var(--space-2);
  border-radius: var(--radius-sm);
  font-size: var(--font-size-xs);
  font-weight: var(--font-weight-semibold);
  cursor: pointer;
  transition: all var(--transition-fast);
}

.score-badge-value {
  font-family: var(--font-mono);
  font-size: var(--font-size-sm);
}

.score-badge-chevron {
  width: 12px;
  height: 12px;
  transition: transform var(--transition-fast);
}

.score-badge-chevron.expanded {
  transform: rotate(180deg);
}

/* Score Breakdown Popover */
.score-breakdown-wrapper {
  position: relative;
}

.score-breakdown {
  position: absolute;
  top: calc(100% + var(--space-2));
  inset-inline-end: 0;
  z-index: 50;
  min-width: 200px;
  padding: var(--space-3);
  background: var(--color-bg-elevated);
  border: 1px solid var(--color-border);
  border-radius: var(--radius-md);
  box-shadow: var(--shadow-lg);
}

.score-breakdown-title {
  font-size: var(--font-size-xs);
  font-weight: var(--font-weight-semibold);
  color: var(--color-text-secondary);
  text-transform: uppercase;
  letter-spacing: 0.03em;
  margin-bottom: var(--space-2);
}

.score-breakdown-row {
  display: flex;
  justify-content: space-between;
  align-items: center;
  padding: var(--space-1) 0;
  font-size: var(--font-size-sm);
}

.score-breakdown-label {
  color: var(--color-text-secondary);
}

.score-breakdown-value {
  font-family: var(--font-mono);
  font-weight: var(--font-weight-medium);
}

.score-breakdown-value.positive {
  color: var(--color-success);
}

.score-breakdown-value.zero {
  color: var(--color-text-muted);
}

.score-breakdown-total {
  border-top: 1px solid var(--color-border);
  margin-top: var(--space-2);
  padding-top: var(--space-2);
  font-weight: var(--font-weight-semibold);
}

/* Matching Confirmation Preview */
.matching-confirmation {
  display: flex;
  flex-direction: column;
  gap: var(--space-4);
  padding: var(--space-4);
  background: var(--color-bg);
  border: 1px solid var(--color-border);
  border-radius: var(--radius-lg);
  margin: var(--space-4) 0;
}

.matching-confirmation-header {
  text-align: center;
  font-weight: var(--font-weight-semibold);
  color: var(--color-text);
}

.matching-confirmation-preview {
  display: flex;
  align-items: center;
  gap: var(--space-3);
}

.matching-confirmation-card {
  flex: 1;
  padding: var(--space-3);
  background: var(--color-bg-elevated);
  border: 1px solid var(--color-border);
  border-radius: var(--radius-md);
}

.matching-confirmation-card-title {
  font-size: var(--font-size-xs);
  font-weight: var(--font-weight-semibold);
  color: var(--color-text-muted);
  text-transform: uppercase;
  letter-spacing: 0.03em;
  margin-bottom: var(--space-1);
}

.matching-confirmation-card-main {
  font-weight: var(--font-weight-medium);
  color: var(--color-text);
  margin-bottom: 2px;
}

.matching-confirmation-card-meta {
  font-size: var(--font-size-sm);
  color: var(--color-text-secondary);
}

.matching-confirmation-card-amount {
  font-family: var(--font-mono);
  font-weight: var(--font-weight-semibold);
  margin-top: var(--space-2);
}

.matching-confirmation-arrow {
  flex-shrink: 0;
  color: var(--color-primary);
}

.matching-confirmation-actions {
  display: flex;
  gap: var(--space-2);
  justify-content: center;
}

/* Matching Success State */
.matching-success {
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  padding: var(--space-8);
  text-align: center;
  animation: fadeIn var(--transition-normal);
}

.matching-success-icon {
  width: 64px;
  height: 64px;
  color: var(--color-success);
  margin-bottom: var(--space-4);
  animation: successPop 0.4s ease-out;
}

@keyframes successPop {
  0% {
    transform: scale(0);
    opacity: 0;
  }
  50% {
    transform: scale(1.2);
  }
  100% {
    transform: scale(1);
    opacity: 1;
  }
}

.matching-success-title {
  font-size: var(--font-size-lg);
  font-weight: var(--font-weight-semibold);
  color: var(--color-text);
  margin: 0 0 var(--space-2) 0;
}

.matching-success-message {
  font-size: var(--font-size-sm);
  color: var(--color-text-secondary);
  margin: 0;
}

/* Matching Empty State */
.matching-empty {
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  padding: var(--space-8);
  text-align: center;
  color: var(--color-text-muted);
}

/* RTL Support for Matching Components */
[dir="rtl"] .matching-confirmation-arrow {
  transform: scaleX(-1);
}

[dir="rtl"] .score-breakdown {
  inset-inline-start: 0;
  inset-inline-end: auto;
}

/* Dark Mode Adjustments */
@media (prefers-color-scheme: dark) {
  .matching-item-suggested {
    background: color-mix(in oklab, var(--color-bg-elevated) 90%, var(--color-primary) 10%);
  }

  .matching-context-card {
    background: color-mix(in oklab, var(--color-bg-elevated) 85%, var(--color-primary) 15%);
  }
}
